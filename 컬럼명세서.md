# 📋 컬럼명세서 (Column Specification)

## 기본 정보
- **데이터 소스**: AUC기본소스2508_lvt_done_month_수정.csv
- **전체 데이터 수**: 95,199건
- **분석 대상 기간**: 2023-05-01 ~ 2024-04-30 (20,758건)
- **업데이트 일자**: 2025-09-28

---

## 컬럼 상세 명세

| 컬럼명                  | 데이터 타입 | 설명                  | 예시값                                                         | 비고                                |
| ----------------------- | ----------- | --------------------- | -------------------------------------------------------------- | ----------------------------------- |
| `crda`                  | datetime    | 고객 결제일           | 2020-07-26                                                     | 최초 결제 시점, fst_pay_date와 동일 |
| `lecture_vt_No`         | int         | 수업 고유번호         | 4351                                                           | Primary Key                         |
| `student_user_No`       | int         | 학생 고유번호         | 385807                                                         | 수업 단위 분석이므로 제외           |
| `tutoring_state`        | object      | 수업 상태             | finish, auto_finish, done, nocard, nopay (중단) / 그 외 (활성) | 이탈 여부 판단 기준                 |
| `done_month`            | float       | 수업 잔존기간 (개월)  | 67.875, 60.0, 59.5                                             | **핵심 타겟 변수**, 4주=1개월 기준  |
| `fst_months`            | float       | 최초 결제 기간 (개월) | 1.0, 3.0, 6.0, 12.0                                            | 패키지별 분석 기준                  |
| `lst_tutoring_datetime` | datetime    | 마지막 수업 일시      | 2025-08-13 23:00:00                                            | 활성 수업 중단 판단 기준            |
| `lst_done_at`           | datetime    | 중단 요청 처리일      | 2024-10-10 11:17:53                                            | 모델 계산에 직접 반영하지 않음      |
---

## 데이터 분포 현황

### 1. 수업 상태 (`tutoring_state`)
- **ACTIVE**: 진행 중인 수업
- **FINISH**: 정상 완료
- **AUTO_FINISH**: 자동 완료
- **DONE**: 완료
- **NOPAY**: 미결제
- **MATCHED**: 매칭됨
- **REMATCH_B**: 재매칭

### 2. 결제 순번 (`p_rn`) 분포
- **1회차**: 90,070건 (94.6%) - 신규 고객
- **2회차**: 1,893건 (2.0%)
- **3회차 이상**: 3,236건 (3.4%)
- **최대**: 43회차

### 3. 재활성화 구분 (`reactive`)
- **not_reactive**: 84,657건 (88.9%) - 일반 고객
- **after_reactive_datetime**: 5,409건 (5.7%) - 재활성화 후
- **before_reactive_datetime**: 5,133건 (5.4%) - 재활성화 전

### 4. 학년 분포 (`grade`)
- **N수생**: 37,676건 (39.6%)
- **고3**: 18,928건 (19.9%)
- **고2**: 16,376건 (17.2%)
- **고1**: 10,552건 (11.1%)
- **중3**: 6,583건 (6.9%)
- **기타**: 5,084건 (5.3%)

### 5. 최초 결제 기간 (`fst_months`)
- **3개월**: 57,786건 (60.8%)
- **1개월**: 31,723건 (33.3%)
- **6개월**: 4,881건 (5.1%)
- **12개월**: 517건 (0.5%)
- **기타**: 292건 (0.3%)

---

## AUC 모델링 관련 핵심 컬럼

### 🎯 타겟 변수
- **`done_month`**: 수업 잔존기간 (개월) - Kaplan-Meier 생존분석의 시간축

### 📅 시간 관련 컬럼
- **`crda`**: 수업 시작일 (코호트 분석 기준점)
- **`lst_tutoring_datetime`**: 실제 종료 시점
- **`fst_pay_date`**: 결제 시작점

### 🔍 세그먼트 변수
- **`grade`**: 학년별 분석
- **`subject`**: 과목별 분석
- **`p_rn`**: 결제 순번별 분석
- **`reactive`**: 재활성화 여부별 분석

---

## 데이터 품질 이슈

### ⚠️ 결측값 (Missing Values)
- **`reactive_datetime`**: 89,790건 (94.3%) - 대부분 재활성화 없음
- **`lst_done_at`**: 활성 고객의 경우 NaT
- **`lst_tutoring_datetime`**: 일부 데이터 오류 가능성

### 🔍 검증 필요 사항
1. **`done_month` vs 실제 계산값 비교**
   - 28일 기준 vs 30일 기준 차이
   - 2,503건(28일) vs 6,564건(30일) 불일치

2. **이탈 상태 정의**
   - `tutoring_state`의 'FINISH', 'AUTO_FINISH', 'DONE' 등을 이탈로 분류
   - 'ACTIVE', 'MATCHED' 등은 우측절단(Right Censoring)

3. **구간 컨벤션 통일**
   - 현재 모델과 대시보드 기준 차이
   - 첫 수업 전 이탈률: 모델 5.25% vs 실제 ~10%

---

## 활용 방안

### 📊 생존 분석
- **Event**: 수업 종료 (`tutoring_state`가 이탈 상태)
- **Time**: 잔존기간 (`done_month`)
- **Censoring**: 진행 중인 수업 (ACTIVE 등)

### 🎯 AUC 계산
- **기준선**: Kaplan-Meier 추정치 (현재 ~5.85-6.07개월)
- **개선 시뮬레이션**: 특정 구간 이탈률 개선 효과 측정
- **ΔAUC**: 개선 전후 AUC 차이

### 📈 세그먼트 분석
- 학년별, 과목별, 결제순번별 생존곡선 비교
- 재활성화 고객의 잔존기간 특성 분석